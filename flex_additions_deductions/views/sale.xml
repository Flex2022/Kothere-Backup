<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <!-- Inherit Form View to Modify it -->
    <record id="view_order_form_inherit555" model="ir.ui.view">
        <field name="name">view.order.form.inherit555</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='partner_id']" position="after">
                <field name="project_invoice" invisible="company_id.flex_additions_deductions_ids == False"/>
                <field name="project_manager" invisible="company_id.flex_additions_deductions_ids == False"/>
                <field name="projects_manager" invisible="company_id.flex_additions_deductions_ids == False"/>
                <field name="deductions_no" invisible="1" readonly="1"/>
                <field name="there_is_access_from_company_id" invisible="1" readonly="1"/>
            </xpath>

            <xpath expr="//page[@name='order_lines']" position="after">

                <page string="Additions/Deductions" name="flex_additions_deductions_tab"
                      invisible="there_is_access_from_company_id == False">

                    <h2>Deductions</h2>
                    <!--                       there_is_access_from_company_id == False-->
                    <field name="flex_deductions_ids" widget="one2many_list">
                        <tree editable="bottom">
                            <field name="deductions_id" options="{'no_create': True}"/>
                            <field name="name"/>
                            <field name="is_percentage"/>
                            <field name="tax_id"/>
                            <field name="percentage_or_value"/>
                            <field name="amount"/>
                        </tree>
                        <form>
                            <group>
                                <field name="deductions_id" options="{'no_create': True}"/>
                                <field name="name"/>
                                <field name="is_percentage"/>
                                <field name="tax_id" options="{'no_create': True}"/>
                                <field name="percentage_or_value"/>
                                <field name="amount"/>
                            </group>
                        </form>
                    </field>
                    <h2>Additions</h2>
                    <field name="flex_additions_ids" widget="one2many_list">
                        <tree editable="bottom">
                            <field name="additions_id" options="{'no_create': True}"/>
                            <field name="name"/>
                            <field name="is_percentage"/>
                            <field name="tax_id" options="{'no_create': True}"/>
                            <field name="percentage_or_value"/>
                            <field name="amount"/>
                        </tree>
                        <form>
                            <group>
                                <field name="additions_id"/>
                                <field name="name"/>
                                <field name="is_percentage"/>
                                <field name="tax_id"/>
                                <field name="percentage_or_value"/>
                                <field name="amount"/>
                            </group>
                        </form>
                    </field>
                </page>
            </xpath>


            <xpath expr="//group[@name='note_group']" position="replace">
                    <group col="12" class="note_group">
                        <group colspan="6">
                            <field name="note" placeholder="Terms and Conditions" colspan="2" nolabel="1"/>
                        </group>

                        <group class="oe_subtotal_footer oe_right" colspan="2"
                               name="sale_total">
                            <field name="amount_untaxed" widget='monetary'
                                   options="{'currency_field': 'currency_id'}"/>
                            <field name="deductions_amount_type_discounts" widget='monetary'
                                   options="{'currency_field': 'currency_id'}"
                                   invisible="there_is_access_from_company_id == False"/>
                            <field name="deductions_amount_type_insurances" widget='monetary'
                                   options="{'currency_field': 'currency_id'}"
                                   invisible="there_is_access_from_company_id == False"/>
                            <field name="deductions_amount_type_advance_payment" widget='monetary'
                                   options="{'currency_field': 'currency_id'}"
                                   invisible="there_is_access_from_company_id == False"/>
                            <field name="deductions_amount_type_business_guarantee" widget='monetary'
                                   options="{'currency_field': 'currency_id'}"
                                   invisible="there_is_access_from_company_id == False"/>
                            <field name="deductions_amount" widget='monetary'
                                   options="{'currency_field': 'currency_id'}"
                                   invisible="there_is_access_from_company_id == False"/>
                            <field name="additions_amount" widget='monetary'
                                   options="{'currency_field': 'currency_id'}"
                                   invisible="there_is_access_from_company_id == False"/>
                            <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                                <label for="total_deductions"/>
                            </div>
                            <field name="total_deductions" nolabel="1"
                                   class="oe_subtotal_footer_separator"
                                   widget='monetary'
                                   options="{'currency_field': 'currency_id'}"/>
                            <!--                            <field name="total_deductions" widget='monetary'-->
                            <!--                                   options="{'currency_field': 'currency_id'}"/>-->
                            <field name="amount_tax" widget='monetary'
                                   options="{'currency_field': 'currency_id'}"/>
                            <div class="oe_subtotal_footer_separator oe_inline o_td_label" invisible="1">
                                <label for="amount_total"/>
                            </div>
                            <field name="amount_total" nolabel="1"
                                   class="oe_subtotal_footer_separator"
                                   widget='monetary'
                                   options="{'currency_field': 'currency_id'}" invisible="1"/>

                            <div class="oe_subtotal_footer_separator oe_inline o_td_label"
                                 invisible="there_is_access_from_company_id == False">
                                <label for="all_total_deductions"/>
                            </div>
                            <field name="all_total_deductions" nolabel="1"
                                   class="oe_subtotal_footer_separator"
                                   widget='monetary'
                                   options="{'currency_field': 'currency_id'}"
                                   invisible="there_is_access_from_company_id == False"/>
                        </group>

                        <div class="clearfix"/>
                    </group>
                </xpath>

        </field>
    </record>
</odoo>